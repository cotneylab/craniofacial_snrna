#loading inHouse data
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-1/outs/raw_feature_bc_matrix.h5")
library(Seurat)
library(tidyverse)
library(harmony)
#loading inHouse data
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-1/outs/raw_feature_bc_matrix.h5")
counts
CS12_1 <- CreateSeuratObject(counts$`Gene Expression`,assay = "RNA",project = "CS12_1")
CS12_1
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-1/outs/filtered_feature_bc_matrix.h5")
CS12_1_filtered <- CreateSeuratObject(counts$`Gene Expression`,assay = "RNA",project = "CS12_1")
CS12_1_filtered
cells <- tibble(
cell = colnames(transcripts$raw$merged),
sample = colnames(transcripts$raw$merged) %>%
strsplit('-') %>%
vapply(FUN.VALUE = character(1), `[`, 2) %>%
factor(levels = sample_names),
nCount = colSums(transcripts$raw$merged),
nFeature = colSums(transcripts$raw$merged != 0)
)
cells <- tibble(
cell = colnames(CS12_1@assays$RNA$counts),
sample = colnames(CS12_1@meta.data$orig.ident) %>%
strsplit('-') %>%
vapply(FUN.VALUE = character(1), `[`, 2) %>%
factor(levels = sample_names),
nCount = colSums(CS12_1@assays$RNA$counts),
nFeature = colSums(CS12_1@assays$RNA$counts != 0)
)
CS12_1[["percent.mt"]] <- PercentageFeatureSet(CS12_1, pattern = "^MT-")
CS12_1_filtered[["percent.mt"]] <- PercentageFeatureSet(CS12_1_filtered, pattern = "^MT-")
VlnPlot(CS12_1, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
VlnPlot(CS12_1_filtered, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
CS12_1.filt <- subset(CS12_1, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
CS12_1_filtered.filt <- subset(CS12_1_filtered, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
VlnPlot(CS12_1.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
VlnPlot(CS12_1_filtered.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
CS12_1.filt
CS12_1_filtered.filt
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-3/outs/raw_feature_bc_matrix.h5")
CS12_3 <- CreateSeuratObject(counts$`Gene Expression`,assay = "RNA",project = "CS12_1")
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-3/outs/filtered_feature_bc_matrix.h5")
CS12_3_filtered <- CreateSeuratObject(counts$`Gene Expression`,assay = "RNA",project = "CS12_1")
CS12_3.filt <- subset(CS12_3, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
VlnPlot(CS12_3.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
CS12_3.filt <- subset(CS12_3, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
CS12_3_filtered.filt <- subset(CS12_3_filtered, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
CS12_3[["percent.mt"]] <- PercentageFeatureSet(CS12_3, pattern = "^MT-")
CS12_3_filtered[["percent.mt"]] <- PercentageFeatureSet(CS12_3_filtered, pattern = "^MT-")
CS12_3.filt <- subset(CS12_3, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
CS12_3_filtered.filt <- subset(CS12_3_filtered, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
VlnPlot(CS12_3.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
VlnPlot(CS12_3_filtered.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-3/outs/raw_feature_bc_matrix.h5")
CS12_3 <- CreateSeuratObject(counts$`Gene Expression`,assay = "RNA",project = "CS12_3")
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-3/outs/filtered_feature_bc_matrix.h5")
CS12_3_filtered <- CreateSeuratObject(counts$`Gene Expression`,assay = "RNA",project = "CS12_3")
CS12_3[["percent.mt"]] <- PercentageFeatureSet(CS12_3, pattern = "^MT-")
CS12_3_filtered[["percent.mt"]] <- PercentageFeatureSet(CS12_3_filtered, pattern = "^MT-")
CS12_3.filt <- subset(CS12_3, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
CS12_3_filtered.filt <- subset(CS12_3_filtered, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
VlnPlot(CS12_3.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
VlnPlot(CS12_3_filtered.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-3/outs/raw_feature_bc_matrix.h5")
CS12_2 <- CreateSeuratObject(counts$`Gene Expression`,assay = "RNA",project = "CS12_2")
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-3/outs/filtered_feature_bc_matrix.h5")
CS12_2_filtered <- CreateSeuratObject(counts$`Gene Expression`,assay = "RNA",project = "CS12_2")
CS12_2[["percent.mt"]] <- PercentageFeatureSet(CS12_2, pattern = "^MT-")
CS12_2_filtered[["percent.mt"]] <- PercentageFeatureSet(CS12_2_filtered, pattern = "^MT-")
CS12_2.filt <- subset(CS12_2, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
CS12_2_filtered.filt <- subset(CS12_2_filtered, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
VlnPlot(CS12_2.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
VlnPlot(CS12_2_filtered.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
CS12_1
CS12_2
CS12_3
CS12_1.filt
CS12_2.filt
CS12_3.filt
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-2/outs/raw_feature_bc_matrix.h5")
CS12_2 <- CreateSeuratObject(counts$`Gene Expression`,assay = "RNA",project = "CS12_2")
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-2/outs/filtered_feature_bc_matrix.h5")
CS12_2_filtered <- CreateSeuratObject(counts$`Gene Expression`,assay = "RNA",project = "CS12_2")
CS12_2[["percent.mt"]] <- PercentageFeatureSet(CS12_2, pattern = "^MT-")
CS12_2_filtered[["percent.mt"]] <- PercentageFeatureSet(CS12_2_filtered, pattern = "^MT-")
CS12_2.filt <- subset(CS12_2, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
CS12_2_filtered.filt <- subset(CS12_2_filtered, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
VlnPlot(CS12_2.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
VlnPlot(CS12_2_filtered.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
CS12_1.filt
CS12_2.filt
CS12_3.filt
CS12_1_filtered.filt
CS12_2_filtered.filt
CS12_3_filtered.filt
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-3/outs/raw_feature_bc_matrix.h5")
CS12_4 <- CreateSeuratObject(counts$`Gene Expression`,assay = "RNA",project = "CS12_4")
counts <- Read10X_h5("/Volumes/Cotney_Lab/globus/jcotney/DATA/Multiome/cellranger_arc_counts/cellranger_count_CS12-3/outs/filtered_feature_bc_matrix.h5")
CS12_4_filtered <- CreateSeuratObject(counts$`Gene Expression`,assay = "RNA",project = "CS12_4")
CS12_4[["percent.mt"]] <- PercentageFeatureSet(CS12_4, pattern = "^MT-")
CS12_4_filtered[["percent.mt"]] <- PercentageFeatureSet(CS12_4_filtered, pattern = "^MT-")
CS12_4.filt <- subset(CS12_4, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
CS12_4_filtered.filt <- subset(CS12_4_filtered, subset = nFeature_RNA < 7000 & nCount_RNA < 25000 & percent.mt < 10 & nCount_RNA > 500 & nFeature_RNA > 500)
VlnPlot(CS12_4.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
VlnPlot(CS12_4_filtered.filt, features = c("nFeature_RNA", "nCount_RNA", "percent.mt"), ncol = 3)
CS12_4.filt
CS12_4_filtered.filt
